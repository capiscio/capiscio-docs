# Go API Reference

<!-- Code generated by gomarkdoc. DO NOT EDIT -->

!!! info "Auto-generated Documentation"
    This API reference is automatically generated from the Go source code in 
    [capiscio-core](https://github.com/capiscio/capiscio-core) using `gomarkdoc`.
    
    **Regenerate:** `gomarkdoc ./pkg/... > docs/reference/go-api.md`

---

## Package: agentcard

```go
import "github.com/capiscio/capiscio-core/pkg/agentcard"
```

Package agentcard defines the data structures for the A2A Agent Card.

## Index

- [type AgentCapabilities](<#AgentCapabilities>)
- [type AgentCard](<#AgentCard>)
- [type AgentExtension](<#AgentExtension>)
- [type AgentInterface](<#AgentInterface>)
- [type AgentProvider](<#AgentProvider>)
- [type AgentSkill](<#AgentSkill>)
- [type SecurityScheme](<#SecurityScheme>)
- [type Signature](<#Signature>)
- [type TransportProtocol](<#TransportProtocol>)


<a name="AgentCapabilities"></a>
## type [AgentCapabilities](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L44-L48>)

AgentCapabilities defines the capabilities supported by the agent.

```go
type AgentCapabilities struct {
    Streaming              bool `json:"streaming,omitempty"`
    PushNotifications      bool `json:"pushNotifications,omitempty"`
    StateTransitionHistory bool `json:"stateTransitionHistory,omitempty"`
}
```

<a name="AgentCard"></a>
## type [AgentCard](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L15-L35>)

AgentCard represents the A2A Agent Card structure based on v0.3.0 specification.

```go
type AgentCard struct {
    ProtocolVersion                   string                    `json:"protocolVersion"`
    Name                              string                    `json:"name"`
    Description                       string                    `json:"description"`
    URL                               string                    `json:"url"`
    PreferredTransport                TransportProtocol         `json:"preferredTransport,omitempty"`
    AdditionalInterfaces              []AgentInterface          `json:"additionalInterfaces,omitempty"`
    Provider                          *AgentProvider            `json:"provider,omitempty"`
    IconURL                           string                    `json:"iconUrl,omitempty"`
    Version                           string                    `json:"version"`
    DocumentationURL                  string                    `json:"documentationUrl,omitempty"`
    Capabilities                      AgentCapabilities         `json:"capabilities"`
    SecuritySchemes                   map[string]SecurityScheme `json:"securitySchemes,omitempty"`
    Security                          []map[string][]string     `json:"security,omitempty"`
    DefaultInputModes                 []string                  `json:"defaultInputModes"`
    DefaultOutputModes                []string                  `json:"defaultOutputModes"`
    Skills                            []AgentSkill              `json:"skills"`
    SupportsAuthenticatedExtendedCard bool                      `json:"supportsAuthenticatedExtendedCard,omitempty"`
    Signatures                        []Signature               `json:"signatures,omitempty"`
    Extensions                        []AgentExtension          `json:"extensions,omitempty"`
}
```

<a name="AgentExtension"></a>
## type [AgentExtension](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L83-L87>)

AgentExtension defines an extension supported by the agent.

```go
type AgentExtension struct {
    Name        string `json:"name"`
    Version     string `json:"version"`
    Description string `json:"description,omitempty"`
}
```

<a name="AgentInterface"></a>
## type [AgentInterface](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L51-L54>)

AgentInterface defines additional interfaces for the agent.

```go
type AgentInterface struct {
    URL       string            `json:"url"`
    Transport TransportProtocol `json:"transport"`
}
```

<a name="AgentProvider"></a>
## type [AgentProvider](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L38-L41>)

AgentProvider contains information about the agent's provider.

```go
type AgentProvider struct {
    Organization string `json:"organization"`
    URL          string `json:"url"`
}
```

<a name="AgentSkill"></a>
## type [AgentSkill](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L66-L74>)

AgentSkill defines a skill provided by the agent.

```go
type AgentSkill struct {
    ID          string   `json:"id"`
    Name        string   `json:"name"`
    Description string   `json:"description"`
    Tags        []string `json:"tags"`
    Examples    []string `json:"examples,omitempty"`
    InputModes  []string `json:"inputModes,omitempty"`
    OutputModes []string `json:"outputModes,omitempty"`
}
```

<a name="SecurityScheme"></a>
## type [SecurityScheme](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L57-L63>)

SecurityScheme defines the security schemes used by the agent.

```go
type SecurityScheme struct {
    Type             string      `json:"type"`
    Scheme           string      `json:"scheme,omitempty"`
    BearerFormat     string      `json:"bearerFormat,omitempty"`
    OpenIDConnectURL string      `json:"openIdConnectUrl,omitempty"`
    Flows            interface{} `json:"flows,omitempty"` // Using interface{} as 'any'
}
```

<a name="Signature"></a>
## type [Signature](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L77-L80>)

Signature represents a JWS signature on the Agent Card.

```go
type Signature struct {
    Protected string `json:"protected"`
    Signature string `json:"signature"`
}
```

<a name="TransportProtocol"></a>
## type [TransportProtocol](<https://github.com/capiscio/capiscio-core/blob/main/pkg/agentcard/types.go#L5>)

TransportProtocol defines the supported transport protocols for A2A agents.

```go
type TransportProtocol string
```

<a name="TransportJSONRPC"></a>Supported Transport Protocols.

```go
const (
    TransportJSONRPC  TransportProtocol = "JSONRPC"
    TransportGRPC     TransportProtocol = "GRPC"
    TransportHTTPJSON TransportProtocol = "HTTP+JSON"
)
```

# badge

```go
import "github.com/capiscio/capiscio-core/pkg/badge"
```

Package badge provides functionality for issuing and verifying Trust Badges.

## Index

- [func SignBadge\(claims \*Claims, privateKey crypto.PrivateKey\) \(string, error\)](<#SignBadge>)
- [type Claims](<#Claims>)
- [type CredentialSubject](<#CredentialSubject>)
- [type Keeper](<#Keeper>)
  - [func NewKeeper\(config KeeperConfig\) \*Keeper](<#NewKeeper>)
  - [func \(k \*Keeper\) CheckAndRenew\(\) error](<#Keeper.CheckAndRenew>)
  - [func \(k \*Keeper\) Renew\(\) error](<#Keeper.Renew>)
  - [func \(k \*Keeper\) Run\(ctx context.Context\) error](<#Keeper.Run>)
- [type KeeperConfig](<#KeeperConfig>)
- [type VerifiableCredential](<#VerifiableCredential>)
- [type Verifier](<#Verifier>)
  - [func NewVerifier\(reg registry.Registry\) \*Verifier](<#NewVerifier>)
  - [func \(v \*Verifier\) Verify\(ctx context.Context, token string\) \(\*Claims, error\)](<#Verifier.Verify>)


<a name="SignBadge"></a>
## func [SignBadge](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/issuer.go#L14>)

```go
func SignBadge(claims *Claims, privateKey crypto.PrivateKey) (string, error)
```

SignBadge creates a signed JWS token from the given claims using the private key. It defaults to EdDSA \(Ed25519\) signing.

<a name="Claims"></a>
## type [Claims](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/schema.go#L7-L25>)

Claims represents the JWT claims payload for a CapiscIO Trust Badge. It follows the structure defined in the Minimal Authority Stack plan.

```go
type Claims struct {
    // Issuer is the entity that issued the badge (e.g., "https://registry.capisc.io").
    Issuer string `json:"iss"`

    // Subject is the unique identifier of the Agent (e.g., "did:capiscio:agent:12345").
    Subject string `json:"sub"`

    // IssuedAt is the timestamp when the badge was issued (Unix timestamp).
    IssuedAt int64 `json:"iat"`

    // Expiry is the timestamp when the badge expires (Unix timestamp).
    Expiry int64 `json:"exp"`

    // Key is the public key of the subject, embedded for offline verification.
    Key *jose.JSONWebKey `json:"key,omitempty"`

    // VC contains the Verifiable Credential data.
    VC  VerifiableCredential `json:"vc"`
}
```

<a name="CredentialSubject"></a>
## type [CredentialSubject](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/schema.go#L37-L43>)

CredentialSubject contains the specific claims.

```go
type CredentialSubject struct {
    // Domain is the security domain of the agent (e.g., "finance.internal").
    Domain string `json:"domain,omitempty"`

    // Level indicates the trust level (RFC-002 ยง5): "0"=SS, "1"=REG, "2"=DV, "3"=OV, "4"=EV.
    Level string `json:"level,omitempty"`
}
```

<a name="Keeper"></a>
## type [Keeper](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L26-L28>)

Keeper manages the lifecycle of a Trust Badge file.

```go
type Keeper struct {
    // contains filtered or unexported fields
}
```

<a name="NewKeeper"></a>
### func [NewKeeper](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L31>)

```go
func NewKeeper(config KeeperConfig) *Keeper
```

NewKeeper creates a new Keeper.

<a name="Keeper.CheckAndRenew"></a>
### func \(\*Keeper\) [CheckAndRenew](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L65>)

```go
func (k *Keeper) CheckAndRenew() error
```

CheckAndRenew checks if the badge needs renewal and renews it if necessary.

<a name="Keeper.Renew"></a>
### func \(\*Keeper\) [Renew](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L104>)

```go
func (k *Keeper) Renew() error
```

Renew generates a new badge and writes it to disk.

<a name="Keeper.Run"></a>
### func \(\*Keeper\) [Run](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L42>)

```go
func (k *Keeper) Run(ctx context.Context) error
```

Run starts the keeper loop.

<a name="KeeperConfig"></a>
## type [KeeperConfig](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/keeper.go#L16-L23>)

KeeperConfig holds configuration for the Badge Keeper.

```go
type KeeperConfig struct {
    PrivateKey    crypto.PrivateKey
    Claims        Claims
    OutputFile    string
    Expiry        time.Duration
    RenewBefore   time.Duration
    CheckInterval time.Duration
}
```

<a name="VerifiableCredential"></a>
## type [VerifiableCredential](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/schema.go#L28-L34>)

VerifiableCredential represents the simplified VC object.

```go
type VerifiableCredential struct {
    // Type is the JSON-LD type(s) of the credential.
    Type []string `json:"type"`

    // CredentialSubject contains the claims about the subject.
    CredentialSubject CredentialSubject `json:"credentialSubject"`
}
```

<a name="Verifier"></a>
## type [Verifier](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/verifier.go#L14-L16>)

Verifier validates TrustBadges.

```go
type Verifier struct {
    // contains filtered or unexported fields
}
```

<a name="NewVerifier"></a>
### func [NewVerifier](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/verifier.go#L19>)

```go
func NewVerifier(reg registry.Registry) *Verifier
```

NewVerifier creates a new Badge Verifier.

<a name="Verifier.Verify"></a>
### func \(\*Verifier\) [Verify](<https://github.com/capiscio/capiscio-core/blob/main/pkg/badge/verifier.go#L26>)

```go
func (v *Verifier) Verify(ctx context.Context, token string) (*Claims, error)
```

Verify checks the validity of a TrustBadge JWS token.

# crypto

```go
import "github.com/capiscio/capiscio-core/pkg/crypto"
```

Package crypto provides cryptographic utilities for CapiscIO.

## Index

- [func CreateCanonicalJSON\(card \*agentcard.AgentCard\) \(\[\]byte, error\)](<#CreateCanonicalJSON>)
- [type DefaultJWKSFetcher](<#DefaultJWKSFetcher>)
  - [func NewDefaultJWKSFetcher\(\) \*DefaultJWKSFetcher](<#NewDefaultJWKSFetcher>)
  - [func \(f \*DefaultJWKSFetcher\) Fetch\(ctx context.Context, url string\) \(\*jose.JSONWebKeySet, error\)](<#DefaultJWKSFetcher.Fetch>)
  - [func \(f \*DefaultJWKSFetcher\) FlushCache\(\)](<#DefaultJWKSFetcher.FlushCache>)
  - [func \(f \*DefaultJWKSFetcher\) SetTTL\(ttl time.Duration\)](<#DefaultJWKSFetcher.SetTTL>)
- [type JWKSFetcher](<#JWKSFetcher>)
- [type SignatureResult](<#SignatureResult>)
- [type SignatureVerificationResult](<#SignatureVerificationResult>)
- [type VerificationSummary](<#VerificationSummary>)
- [type Verifier](<#Verifier>)
  - [func NewVerifier\(\) \*Verifier](<#NewVerifier>)
  - [func NewVerifierWithFetcher\(fetcher JWKSFetcher\) \*Verifier](<#NewVerifierWithFetcher>)
  - [func \(v \*Verifier\) VerifyAgentCardSignatures\(ctx context.Context, card \*agentcard.AgentCard\) \(\*SignatureVerificationResult, error\)](<#Verifier.VerifyAgentCardSignatures>)


<a name="CreateCanonicalJSON"></a>
## func [CreateCanonicalJSON](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/canonical.go#L14>)

```go
func CreateCanonicalJSON(card *agentcard.AgentCard) ([]byte, error)
```

CreateCanonicalJSON creates a canonical JSON representation of the Agent Card for signature verification. It removes the "signatures" field and ensures keys are sorted \(which encoding/json does by default\).

<a name="DefaultJWKSFetcher"></a>
## type [DefaultJWKSFetcher](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L25-L30>)

DefaultJWKSFetcher is the default implementation of JWKSFetcher.

```go
type DefaultJWKSFetcher struct {
    // contains filtered or unexported fields
}
```

<a name="NewDefaultJWKSFetcher"></a>
### func [NewDefaultJWKSFetcher](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L33>)

```go
func NewDefaultJWKSFetcher() *DefaultJWKSFetcher
```

NewDefaultJWKSFetcher creates a new fetcher with a default HTTP client and 1 hour cache TTL.

<a name="DefaultJWKSFetcher.Fetch"></a>
### func \(\*DefaultJWKSFetcher\) [Fetch](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L58>)

```go
func (f *DefaultJWKSFetcher) Fetch(ctx context.Context, url string) (*jose.JSONWebKeySet, error)
```

Fetch retrieves the JWKS from the specified URL, using cache if available.

<a name="DefaultJWKSFetcher.FlushCache"></a>
### func \(\*DefaultJWKSFetcher\) [FlushCache](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L51>)

```go
func (f *DefaultJWKSFetcher) FlushCache()
```

FlushCache clears all cached JWKS entries.

<a name="DefaultJWKSFetcher.SetTTL"></a>
### func \(\*DefaultJWKSFetcher\) [SetTTL](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L44>)

```go
func (f *DefaultJWKSFetcher) SetTTL(ttl time.Duration)
```

SetTTL configures the cache time\-to\-live.

<a name="JWKSFetcher"></a>
## type [JWKSFetcher](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/jwks.go#L15-L17>)

JWKSFetcher handles fetching and caching of JSON Web Key Sets.

```go
type JWKSFetcher interface {
    Fetch(ctx context.Context, url string) (*jose.JSONWebKeySet, error)
}
```

<a name="SignatureResult"></a>
## type [SignatureResult](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L22-L30>)

SignatureResult holds the details of a single signature verification.

```go
type SignatureResult struct {
    Index     int
    Valid     bool
    Algorithm string
    KeyID     string
    Issuer    string
    JWKSUri   string
    Error     string
}
```

<a name="SignatureVerificationResult"></a>
## type [SignatureVerificationResult](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L15-L19>)

SignatureVerificationResult contains the result of verifying all signatures.

```go
type SignatureVerificationResult struct {
    Valid      bool
    Signatures []SignatureResult
    Summary    VerificationSummary
}
```

<a name="VerificationSummary"></a>
## type [VerificationSummary](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L33-L38>)

VerificationSummary summarizes the results of all signature verifications.

```go
type VerificationSummary struct {
    Total  int
    Valid  int
    Failed int
    Errors []string
}
```

<a name="Verifier"></a>
## type [Verifier](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L48-L50>)

Verifier handles Agent Card signature verification.

```go
type Verifier struct {
    // contains filtered or unexported fields
}
```

<a name="NewVerifier"></a>
### func [NewVerifier](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L53>)

```go
func NewVerifier() *Verifier
```

NewVerifier creates a new Verifier with the default JWKS fetcher.

<a name="NewVerifierWithFetcher"></a>
### func [NewVerifierWithFetcher](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L60>)

```go
func NewVerifierWithFetcher(fetcher JWKSFetcher) *Verifier
```

NewVerifierWithFetcher creates a new Verifier with a custom JWKS fetcher.

<a name="Verifier.VerifyAgentCardSignatures"></a>
### func \(\*Verifier\) [VerifyAgentCardSignatures](<https://github.com/capiscio/capiscio-core/blob/main/pkg/crypto/verifier.go#L67>)

```go
func (v *Verifier) VerifyAgentCardSignatures(ctx context.Context, card *agentcard.AgentCard) (*SignatureVerificationResult, error)
```

VerifyAgentCardSignatures verifies all signatures in an Agent Card.

# gateway

```go
import "github.com/capiscio/capiscio-core/pkg/gateway"
```

Package gateway provides the HTTP middleware for the CapiscIO Security Sidecar.

## Index

- [func ExtractBadge\(r \*http.Request\) string](<#ExtractBadge>)
- [func NewAuthMiddleware\(verifier \*badge.Verifier, next http.Handler\) http.Handler](<#NewAuthMiddleware>)


<a name="ExtractBadge"></a>
## func [ExtractBadge](<https://github.com/capiscio/capiscio-core/blob/main/pkg/gateway/middleware.go#L39>)

```go
func ExtractBadge(r *http.Request) string
```

ExtractBadge retrieves the badge from headers.

<a name="NewAuthMiddleware"></a>
## func [NewAuthMiddleware](<https://github.com/capiscio/capiscio-core/blob/main/pkg/gateway/middleware.go#L13>)

```go
func NewAuthMiddleware(verifier *badge.Verifier, next http.Handler) http.Handler
```

NewAuthMiddleware creates a middleware that enforces Badge validity.

# protocol

```go
import "github.com/capiscio/capiscio-core/pkg/protocol"
```

Package protocol defines the interfaces and implementations for communicating with A2A agents.

## Index

- [type Client](<#Client>)
- [type HTTPClient](<#HTTPClient>)
  - [func NewHTTPClient\(url string\) \*HTTPClient](<#NewHTTPClient>)
  - [func \(c \*HTTPClient\) Close\(\) error](<#HTTPClient.Close>)
  - [func \(c \*HTTPClient\) Ping\(ctx context.Context\) \(time.Duration, error\)](<#HTTPClient.Ping>)
- [type JSONRPCClient](<#JSONRPCClient>)
  - [func NewJSONRPCClient\(url string\) \*JSONRPCClient](<#NewJSONRPCClient>)
  - [func \(c \*JSONRPCClient\) Close\(\) error](<#JSONRPCClient.Close>)
  - [func \(c \*JSONRPCClient\) Ping\(ctx context.Context\) \(time.Duration, error\)](<#JSONRPCClient.Ping>)


<a name="Client"></a>
## type [Client](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/client.go#L10-L17>)

Client defines the interface for an A2A protocol client.

```go
type Client interface {
    // Ping checks if the agent is reachable and responsive.
    // Returns the latency and any error encountered.
    Ping(ctx context.Context) (time.Duration, error)

    // Close cleans up any resources used by the client.
    Close() error
}
```

<a name="HTTPClient"></a>
## type [HTTPClient](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/http.go#L12-L15>)

HTTPClient implements the Client interface for HTTP\+JSON transport.

```go
type HTTPClient struct {
    // contains filtered or unexported fields
}
```

<a name="NewHTTPClient"></a>
### func [NewHTTPClient](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/http.go#L18>)

```go
func NewHTTPClient(url string) *HTTPClient
```

NewHTTPClient creates a new HTTPClient.

<a name="HTTPClient.Close"></a>
### func \(\*HTTPClient\) [Close](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/http.go#L61>)

```go
func (c *HTTPClient) Close() error
```

Close cleans up resources.

<a name="HTTPClient.Ping"></a>
### func \(\*HTTPClient\) [Ping](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/http.go#L29>)

```go
func (c *HTTPClient) Ping(ctx context.Context) (time.Duration, error)
```

Ping performs a simple GET request to the agent URL to check availability. It attempts to call 'GET /tasks' which is a standard v0.3.0 endpoint.

<a name="JSONRPCClient"></a>
## type [JSONRPCClient](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/jsonrpc.go#L13-L16>)

JSONRPCClient implements the Client interface for JSON\-RPC transport over HTTP.

```go
type JSONRPCClient struct {
    // contains filtered or unexported fields
}
```

<a name="NewJSONRPCClient"></a>
### func [NewJSONRPCClient](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/jsonrpc.go#L19>)

```go
func NewJSONRPCClient(url string) *JSONRPCClient
```

NewJSONRPCClient creates a new JSONRPCClient.

<a name="JSONRPCClient.Close"></a>
### func \(\*JSONRPCClient\) [Close](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/jsonrpc.go#L93>)

```go
func (c *JSONRPCClient) Close() error
```

Close cleans up resources.

<a name="JSONRPCClient.Ping"></a>
### func \(\*JSONRPCClient\) [Ping](<https://github.com/capiscio/capiscio-core/blob/main/pkg/protocol/jsonrpc.go#L50>)

```go
func (c *JSONRPCClient) Ping(ctx context.Context) (time.Duration, error)
```

Ping sends a standard JSON\-RPC request to check availability. It attempts to call 'tasks/list' which is a standard v0.3.0 method. Even if the method returns an empty list or an error \(e.g. auth\), a valid JSON\-RPC response indicates the agent is alive.

# registry

```go
import "github.com/capiscio/capiscio-core/pkg/registry"
```

Package registry implements the Trust Registry interface for key retrieval.

## Index

- [type CloudRegistry](<#CloudRegistry>)
  - [func NewCloudRegistry\(url string\) \*CloudRegistry](<#NewCloudRegistry>)
  - [func \(r \*CloudRegistry\) GetPublicKey\(ctx context.Context, issuer string\) \(crypto.PublicKey, error\)](<#CloudRegistry.GetPublicKey>)
  - [func \(r \*CloudRegistry\) IsRevoked\(\_ context.Context, \_ string\) \(bool, error\)](<#CloudRegistry.IsRevoked>)
- [type LocalRegistry](<#LocalRegistry>)
  - [func NewLocalRegistry\(path string\) \*LocalRegistry](<#NewLocalRegistry>)
  - [func \(r \*LocalRegistry\) GetPublicKey\(\_ context.Context, \_ string\) \(crypto.PublicKey, error\)](<#LocalRegistry.GetPublicKey>)
  - [func \(r \*LocalRegistry\) IsRevoked\(\_ context.Context, \_ string\) \(bool, error\)](<#LocalRegistry.IsRevoked>)
- [type Registry](<#Registry>)


<a name="CloudRegistry"></a>
## type [CloudRegistry](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/cloud.go#L17-L24>)

CloudRegistry implements Registry by fetching keys from a URL.

```go
type CloudRegistry struct {
    RegistryURL string
    Client      *http.Client
    // contains filtered or unexported fields
}
```

<a name="NewCloudRegistry"></a>
### func [NewCloudRegistry](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/cloud.go#L27>)

```go
func NewCloudRegistry(url string) *CloudRegistry
```

NewCloudRegistry creates a new CloudRegistry.

<a name="CloudRegistry.GetPublicKey"></a>
### func \(\*CloudRegistry\) [GetPublicKey](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/cloud.go#L38>)

```go
func (r *CloudRegistry) GetPublicKey(ctx context.Context, issuer string) (crypto.PublicKey, error)
```

GetPublicKey fetches the key from the Registry URL. It assumes the URL returns a single JWK for now \(MVP\).

<a name="CloudRegistry.IsRevoked"></a>
### func \(\*CloudRegistry\) [IsRevoked](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/cloud.go#L80>)

```go
func (r *CloudRegistry) IsRevoked(_ context.Context, _ string) (bool, error)
```

IsRevoked checks revocation \(not implemented for MVP\).

<a name="LocalRegistry"></a>
## type [LocalRegistry](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/local.go#L15-L20>)

LocalRegistry implements Registry using a local file.

```go
type LocalRegistry struct {
    KeyPath string
    // contains filtered or unexported fields
}
```

<a name="NewLocalRegistry"></a>
### func [NewLocalRegistry](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/local.go#L23>)

```go
func NewLocalRegistry(path string) *LocalRegistry
```

NewLocalRegistry creates a new LocalRegistry.

<a name="LocalRegistry.GetPublicKey"></a>
### func \(\*LocalRegistry\) [GetPublicKey](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/local.go#L29>)

```go
func (r *LocalRegistry) GetPublicKey(_ context.Context, _ string) (crypto.PublicKey, error)
```

GetPublicKey reads the key from the local file. It ignores the issuer argument for the MVP \(trusts the local key for all\).

<a name="LocalRegistry.IsRevoked"></a>
### func \(\*LocalRegistry\) [IsRevoked](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/local.go#L61>)

```go
func (r *LocalRegistry) IsRevoked(_ context.Context, _ string) (bool, error)
```

IsRevoked checks if the ID is in the local blocklist \(not implemented yet\).

<a name="Registry"></a>
## type [Registry](<https://github.com/capiscio/capiscio-core/blob/main/pkg/registry/interface.go#L10-L17>)

Registry defines the interface for the CapiscIO Trust Registry. It is responsible for resolving trusted public keys for Issuers.

```go
type Registry interface {
    // GetPublicKey fetches the public key for a given Issuer DID/URI.
    // Returns the public key and any error encountered.
    GetPublicKey(ctx context.Context, issuerDID string) (crypto.PublicKey, error)

    // IsRevoked checks if a specific Badge ID (or Subject) has been revoked.
    IsRevoked(ctx context.Context, badgeID string) (bool, error)
}
```

# report

```go
import "github.com/capiscio/capiscio-core/pkg/report"
```

Package report defines the structures for validation and scoring reports.

## Index

- [type AvailabilityResult](<#AvailabilityResult>)
- [type ValidationIssue](<#ValidationIssue>)
- [type ValidationResult](<#ValidationResult>)
  - [func \(r \*ValidationResult\) AddError\(code, message, field string\)](<#ValidationResult.AddError>)
  - [func \(r \*ValidationResult\) AddWarning\(code, message, field string\)](<#ValidationResult.AddWarning>)


<a name="AvailabilityResult"></a>
## type [AvailabilityResult](<https://github.com/capiscio/capiscio-core/blob/main/pkg/report/types.go#L19-L25>)

AvailabilityResult contains the results of availability testing.

```go
type AvailabilityResult struct {
    Score       float64 `json:"score"`
    Tested      bool    `json:"tested"`
    EndpointURL string  `json:"endpointUrl,omitempty"`
    LatencyMS   int64   `json:"latencyMs,omitempty"`
    Error       string  `json:"error,omitempty"`
}
```

<a name="ValidationIssue"></a>
## type [ValidationIssue](<https://github.com/capiscio/capiscio-core/blob/main/pkg/report/types.go#L28-L33>)

ValidationIssue represents a specific problem found during validation.

```go
type ValidationIssue struct {
    Code     string `json:"code"`
    Message  string `json:"message"`
    Severity string `json:"severity"` // "error", "warning", "info"
    Field    string `json:"field,omitempty"`
}
```

<a name="ValidationResult"></a>
## type [ValidationResult](<https://github.com/capiscio/capiscio-core/blob/main/pkg/report/types.go#L9-L16>)

ValidationResult contains the complete results of an Agent Card validation.

```go
type ValidationResult struct {
    Success         bool                                `json:"success"`
    ComplianceScore float64                             `json:"complianceScore"`
    TrustScore      float64                             `json:"trustScore"`
    Availability    AvailabilityResult                  `json:"availability"`
    Issues          []ValidationIssue                   `json:"issues"`
    Signatures      *crypto.SignatureVerificationResult `json:"signatures,omitempty"`
}
```

<a name="ValidationResult.AddError"></a>
### func \(\*ValidationResult\) [AddError](<https://github.com/capiscio/capiscio-core/blob/main/pkg/report/types.go#L36>)

```go
func (r *ValidationResult) AddError(code, message, field string)
```

AddError adds an error issue to the result.

<a name="ValidationResult.AddWarning"></a>
### func \(\*ValidationResult\) [AddWarning](<https://github.com/capiscio/capiscio-core/blob/main/pkg/report/types.go#L47>)

```go
func (r *ValidationResult) AddWarning(code, message, field string)
```

AddWarning adds a warning issue to the result.

# scoring

```go
import "github.com/capiscio/capiscio-core/pkg/scoring"
```

Package scoring implements the validation and scoring logic for Agent Cards.

## Index

- [type AvailabilityScorer](<#AvailabilityScorer>)
  - [func NewAvailabilityScorer\(timeout time.Duration\) \*AvailabilityScorer](<#NewAvailabilityScorer>)
  - [func \(s \*AvailabilityScorer\) Score\(ctx context.Context, card \*agentcard.AgentCard\) report.AvailabilityResult](<#AvailabilityScorer.Score>)
- [type ComplianceConfig](<#ComplianceConfig>)
- [type ComplianceScorer](<#ComplianceScorer>)
  - [func NewComplianceScorer\(config \*ComplianceConfig\) \*ComplianceScorer](<#NewComplianceScorer>)
  - [func \(s \*ComplianceScorer\) Score\(card \*agentcard.AgentCard\) \(float64, \[\]report.ValidationIssue\)](<#ComplianceScorer.Score>)
- [type Engine](<#Engine>)
  - [func NewEngine\(config \*EngineConfig\) \*Engine](<#NewEngine>)
  - [func \(e \*Engine\) Validate\(ctx context.Context, card \*agentcard.AgentCard, checkAvailability bool\) \(\*report.ValidationResult, error\)](<#Engine.Validate>)
- [type EngineConfig](<#EngineConfig>)
  - [func DefaultEngineConfig\(\) \*EngineConfig](<#DefaultEngineConfig>)
- [type TrustScorer](<#TrustScorer>)
  - [func NewTrustScorer\(trustedIssuers \[\]string\) \*TrustScorer](<#NewTrustScorer>)
  - [func \(s \*TrustScorer\) Score\(sigResult \*crypto.SignatureVerificationResult\) \(float64, \[\]report.ValidationIssue\)](<#TrustScorer.Score>)
- [type URLValidator](<#URLValidator>)
  - [func NewURLValidator\(allowPrivateIPs bool\) \*URLValidator](<#NewURLValidator>)
  - [func \(v \*URLValidator\) Validate\(rawURL string, fieldName string\) \[\]report.ValidationIssue](<#URLValidator.Validate>)
- [type ValidationMode](<#ValidationMode>)


<a name="AvailabilityScorer"></a>
## type [AvailabilityScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/availability.go#L14-L16>)

AvailabilityScorer evaluates the operational status of the agent.

```go
type AvailabilityScorer struct {
    // contains filtered or unexported fields
}
```

<a name="NewAvailabilityScorer"></a>
### func [NewAvailabilityScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/availability.go#L19>)

```go
func NewAvailabilityScorer(timeout time.Duration) *AvailabilityScorer
```

NewAvailabilityScorer creates a new AvailabilityScorer.

<a name="AvailabilityScorer.Score"></a>
### func \(\*AvailabilityScorer\) [Score](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/availability.go#L29>)

```go
func (s *AvailabilityScorer) Score(ctx context.Context, card *agentcard.AgentCard) report.AvailabilityResult
```

Score checks the agent's endpoint and calculates an availability score.

<a name="ComplianceConfig"></a>
## type [ComplianceConfig](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/compliance.go#L17-L19>)

ComplianceConfig holds configuration for the ComplianceScorer.

```go
type ComplianceConfig struct {
    AllowPrivateIPs bool
}
```

<a name="ComplianceScorer"></a>
## type [ComplianceScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/compliance.go#L12-L14>)

ComplianceScorer evaluates how well the Agent Card adheres to the A2A specification.

```go
type ComplianceScorer struct {
    // contains filtered or unexported fields
}
```

<a name="NewComplianceScorer"></a>
### func [NewComplianceScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/compliance.go#L22>)

```go
func NewComplianceScorer(config *ComplianceConfig) *ComplianceScorer
```

NewComplianceScorer creates a new ComplianceScorer.

<a name="ComplianceScorer.Score"></a>
### func \(\*ComplianceScorer\) [Score](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/compliance.go#L34>)

```go
func (s *ComplianceScorer) Score(card *agentcard.AgentCard) (float64, []report.ValidationIssue)
```

Score calculates the compliance score \(0\-100\) and identifies issues.

<a name="Engine"></a>
## type [Engine](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L61-L67>)

Engine is the main entry point for scoring and validation.

```go
type Engine struct {
    // contains filtered or unexported fields
}
```

<a name="NewEngine"></a>
### func [NewEngine](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L71>)

```go
func NewEngine(config *EngineConfig) *Engine
```

NewEngine creates a new scoring Engine with the provided configuration. If config is nil, default configuration is used.

<a name="Engine.Validate"></a>
### func \(\*Engine\) [Validate](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L100>)

```go
func (e *Engine) Validate(ctx context.Context, card *agentcard.AgentCard, checkAvailability bool) (*report.ValidationResult, error)
```

Validate performs a full validation of the Agent Card.

<a name="EngineConfig"></a>
## type [EngineConfig](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L23-L48>)

EngineConfig holds configuration for the scoring Engine.

```go
type EngineConfig struct {
    // TrustedIssuers is a list of trusted JWKS URIs or Issuer IDs.
    // If empty, all valid signatures are considered "trusted" (low security mode).
    TrustedIssuers []string

    // JWKSCacheTTL is the time-to-live for cached JWKS. Default: 1 hour.
    JWKSCacheTTL time.Duration

    // HTTPTimeout is the timeout for availability checks. Default: 5 seconds.
    HTTPTimeout time.Duration

    // Mode determines the validation strictness. Default: ModeProgressive.
    Mode ValidationMode

    // SkipSignatureVerification disables JWS signature verification.
    SkipSignatureVerification bool

    // SchemaOnly skips logic and network checks, validating only the JSON structure.
    SchemaOnly bool

    // RegistryReady enables additional checks required for registry submission.
    RegistryReady bool

    // AllowPrivateIPs allows URLs to resolve to private IP addresses.
    AllowPrivateIPs bool
}
```

<a name="DefaultEngineConfig"></a>
### func [DefaultEngineConfig](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L51>)

```go
func DefaultEngineConfig() *EngineConfig
```

DefaultEngineConfig returns a default configuration.

<a name="TrustScorer"></a>
## type [TrustScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/trust.go#L9-L11>)

TrustScorer evaluates the trustworthiness of the Agent Card.

```go
type TrustScorer struct {
    // contains filtered or unexported fields
}
```

<a name="NewTrustScorer"></a>
### func [NewTrustScorer](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/trust.go#L14>)

```go
func NewTrustScorer(trustedIssuers []string) *TrustScorer
```

NewTrustScorer creates a new TrustScorer with optional trusted issuers.

<a name="TrustScorer.Score"></a>
### func \(\*TrustScorer\) [Score](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/trust.go#L21>)

```go
func (s *TrustScorer) Score(sigResult *crypto.SignatureVerificationResult) (float64, []report.ValidationIssue)
```

Score calculates the trust score \(0\-100\) based on signatures and other factors.

<a name="URLValidator"></a>
## type [URLValidator](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/url_security.go#L13-L15>)

URLValidator validates URLs for security and compliance.

```go
type URLValidator struct {
    AllowPrivateIPs bool
}
```

<a name="NewURLValidator"></a>
### func [NewURLValidator](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/url_security.go#L18>)

```go
func NewURLValidator(allowPrivateIPs bool) *URLValidator
```

NewURLValidator creates a new URLValidator.

<a name="URLValidator.Validate"></a>
### func \(\*URLValidator\) [Validate](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/url_security.go#L25>)

```go
func (v *URLValidator) Validate(rawURL string, fieldName string) []report.ValidationIssue
```

Validate checks if a URL is valid and secure.

<a name="ValidationMode"></a>
## type [ValidationMode](<https://github.com/capiscio/capiscio-core/blob/main/pkg/scoring/engine.go#L13>)

ValidationMode determines the strictness of the validation.

```go
type ValidationMode string
```

<a name="ModeProgressive"></a>

```go
const (
    // ModeProgressive is the default mode. Standard checks, allows some warnings.
    ModeProgressive ValidationMode = "progressive"
    // ModeStrict fails on ANY warning or error.
    ModeStrict ValidationMode = "strict"
)
```

---

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
